apiVersion: batch/v1
kind: Job
metadata:
  name: minio-init
spec:
  template:
    spec:
      containers:
        - name: minio-mc
          image: minio/mc
          command: ["/bin/sh", "-c"]
          args:
            - |
              echo "â³ Esperando a MinIO..."
              until mc alias set myminio http://minio-server:9000 minioadmin minioadmin; do
                echo "... esperando ..."
                sleep 2
              done
              
              echo "ğŸ“¦ Creando bucket 'assets'..."
              mc mb myminio/assets --ignore-existing
              
              echo "ğŸ”“ Haciendo bucket pÃºblico..."
              mc anonymous set download myminio/assets
              
              echo "âœ… MinIO configurado."
      restartPolicy: OnFailure
